<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Cache-control" content="no-cache, no-store, must-revalidate">
  <title>Project manager</title>
  <script src="https://code.jquery.com/jquery-1.10.2.js"></script>

<script>
function xxassign()
{

  var name = get_name();

  term = $("#assign").val();

  var jqxhr = $.post("http://api.openstreetmap.cz/table/project/ " + name, 
                     { gp_id: term, project: name })
  .done(function() {
    alert( "done" );
  })
  .fail(function() {
    alert( "error" );
  })
  .always(function() {
    alert( "finished" );
  });
}

function xxdelete()
{
  var name = get_name();
  var gp_id = $("#delinput").val();
  alert(gp_id);

  $.ajax({
    url: 'http://api.openstreetmap.cz/table/project',
    method: 'DELETE',
    data: { gp_id: gp_id, project: name },
    success: function(result) {
      alert("done");
    },
    error: function(request,msg,error) {
      alert("error");
    }
  });
}

function get_name()
{
  return $("#options").val();
}

</script>

</head>
<body>

<h1>Manage project</h1>

 <select id="options">
  <option value="volvo">Select from here and hit refresh</option>
</select>

<script>
$.getJSON("http://api.openstreetmap.cz/table/projectlist?output=json", function(result) {
    var options = $("#options");
    $.each(result, function( index, value ) {
//      alert( index + ": " + value );
      options.append($("<option />").val(value).text(value));

    });
});
</script>


<script>
function refresh_list()
{

  name = get_name();
  $( "#resultget" ).empty();

//  $.get( "http://api.openstreetmap.cz/table/project/"+name, function( data ) {
//    $( "#resultget" ).append(data);
//  });

  $.getJSON("http://api.openstreetmap.cz/table/project/"+name,
    {
      output: "json",
    },
    function(result) {
      var options = $("#options");
      $.each(result, function( index, value ) {
        data = index + ": <a href='http://api.openstreetmap.cz/" + value[1] + "'>"+value[0]+"</a>";
        $("#resultget").append(data);
        $("#resultget").append(" [remove]");
        $("#resultget").append("\n<br>");
      });
    }
  );
}
</script>

<h2> Images assigned to a project</h2>
<button onclick="refresh_list();">
refresh
</button>

<div id="resultget">
stuff, hit refresh
</div>


<h2>assign image</h2>

<input id="assign" type="text" name="add" placeholder="image id">
<input type="button" value="add" onclick="xxassign()">

<div id="result"></div>

<h2>remove image from project</h2>

<input id="delinput" type="text" name="add" placeholder="delete project">
<input type="button" value="delete" onclick="xxdelete()">

 
</body>
</html>



<script>
</script>